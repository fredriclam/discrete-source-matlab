% Sums the contribution of sources at x, y.
% Fixes one particle, and mirrors the rest about the plane of symmetry

function psum = particle_sum_symm(x,y, fixed_particle, moving_particle, u, ...
    plus_sources, minus_sources)

k = 1;
psum = fixed_particle(x,y);

% Constrained
th_source = 1.138348195955872;
r1 = 1.205563573249634;
psum = psum - moving_particle(x,y,...
    r1*cos(th_source),r1*sin(th_source));
% r2 = 2.917239524946627;
% psum = psum - moving_particle(x,y,...
%     r2*cos(th_source+1.889989107514455),...
%     r2*sin(th_source+1.889989107514455)) ...
%     - moving_particle(x,y,...
%     r2*cos(th_source-1.889989107514455),...
%     r2*sin(th_source-1.889989107514455));

for i = 1:plus_sources
    psum = psum + moving_particle(x,y,...
        u(k)*cos(th_source+u(k+1)), ... r cos th
        u(k)*sin(th_source+u(k+1))) ...
        + moving_particle(x,y,...
        u(k)*cos(th_source-u(k+1)), ... r cos th
        u(k)*sin(th_source-u(k+1)));
    k = k + 2;
end
for i = 1:minus_sources
    psum = psum - moving_particle(x,y,...
        u(k)*cos(th_source+u(k+1)), ... r cos th
        u(k)*sin(th_source+u(k+1))) ...
        - moving_particle(x,y,...
        u(k)*cos(th_source-u(k+1)), ... r cos th
        u(k)*sin(th_source-u(k+1)));
    k = k + 2;
end